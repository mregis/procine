CREATE TABLE empresa (empresa_id INT UNSIGNED AUTO_INCREMENT, empresa_nm_razaosocial VARCHAR(255) NOT NULL, empresa_nm_nomefantasia VARCHAR(20) NOT NULL, empresa_nu_cnpj CHAR(14) DEFAULT '0' NOT NULL, empresa_nu_status TINYINT DEFAULT '1' NOT NULL, PRIMARY KEY(empresa_id)) ENGINE = INNODB;
CREATE TABLE menu (menu_id INT UNSIGNED AUTO_INCREMENT, processo_id INT UNSIGNED, menu_ds_descricao VARCHAR(20) NOT NULL, menu_nu_ordem TINYINT UNSIGNED DEFAULT '1' NOT NULL, menu_nu_menupai INT UNSIGNED DEFAULT '0', menu_nu_status TINYINT UNSIGNED DEFAULT '1' NOT NULL, INDEX processo_id_idx (processo_id), PRIMARY KEY(menu_id)) ENGINE = INNODB;
CREATE TABLE perfil (perfil_id INT UNSIGNED AUTO_INCREMENT, perfil_nm_descricao VARCHAR(50) NOT NULL, perfil_nu_nivel TINYINT UNSIGNED NOT NULL, perfil_nu_status TINYINT UNSIGNED DEFAULT '1' NOT NULL, PRIMARY KEY(perfil_id)) ENGINE = INNODB;
CREATE TABLE perfil_processo (processo_id INT UNSIGNED, perfil_id INT UNSIGNED, PRIMARY KEY(processo_id, perfil_id)) ENGINE = INNODB;
CREATE TABLE processo (processo_id INT UNSIGNED AUTO_INCREMENT, processo_nm_descricao VARCHAR(60) NOT NULL, processo_nm_rota VARCHAR(40) DEFAULT ' ' NOT NULL, processo_nu_status TINYINT UNSIGNED DEFAULT '1' NOT NULL, PRIMARY KEY(processo_id)) ENGINE = INNODB;
CREATE TABLE usuario (usuario_id INT UNSIGNED AUTO_INCREMENT, usuario_nm_nomeacesso VARCHAR(128) NOT NULL, usuario_nm_nome VARCHAR(255) NOT NULL, usuario_nm_email VARCHAR(255) NOT NULL, usuario_nu_cpf CHAR(11) DEFAULT '0' NOT NULL, usuario_dt_dtnascimento DATE DEFAULT '0000-00-00', usuario_nm_algoritmo VARCHAR(128) DEFAULT 'md5', usuario_nm_salt VARCHAR(128), usuario_nm_senha VARCHAR(128) NOT NULL, usuario_nu_status TINYINT UNSIGNED DEFAULT '1' NOT NULL, usuario_ts_ultimoacesso DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, PRIMARY KEY(usuario_id)) ENGINE = INNODB;
CREATE TABLE usuario_empresa (usuario_id INT UNSIGNED, empresa_id INT UNSIGNED, PRIMARY KEY(usuario_id, empresa_id)) ENGINE = INNODB;
CREATE TABLE usuario_perfil (perfil_id INT UNSIGNED, usuario_id INT UNSIGNED, PRIMARY KEY(perfil_id, usuario_id)) ENGINE = INNODB;
CREATE TABLE usuario_processo (usuario_id INT UNSIGNED, processo_id INT UNSIGNED, PRIMARY KEY(usuario_id, processo_id)) ENGINE = INNODB;
CREATE TABLE remember_key (rememberkey_id INT AUTO_INCREMENT, usuario_id INT UNSIGNED, rememberkey_ds_key VARCHAR(32), usuario_ip VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX usuario_id_idx (usuario_id), PRIMARY KEY(rememberkey_id, usuario_ip)) ENGINE = INNODB;
ALTER TABLE menu ADD CONSTRAINT menu_processo_id_processo_processo_id FOREIGN KEY (processo_id) REFERENCES processo(processo_id);
ALTER TABLE perfil_processo ADD CONSTRAINT perfil_processo_processo_id_processo_processo_id FOREIGN KEY (processo_id) REFERENCES processo(processo_id);
ALTER TABLE perfil_processo ADD CONSTRAINT perfil_processo_perfil_id_perfil_perfil_id FOREIGN KEY (perfil_id) REFERENCES perfil(perfil_id);
ALTER TABLE usuario_empresa ADD CONSTRAINT usuario_empresa_usuario_id_usuario_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(usuario_id);
ALTER TABLE usuario_empresa ADD CONSTRAINT usuario_empresa_empresa_id_empresa_empresa_id FOREIGN KEY (empresa_id) REFERENCES empresa(empresa_id);
ALTER TABLE usuario_perfil ADD CONSTRAINT usuario_perfil_usuario_id_usuario_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(usuario_id);
ALTER TABLE usuario_perfil ADD CONSTRAINT usuario_perfil_perfil_id_perfil_perfil_id FOREIGN KEY (perfil_id) REFERENCES perfil(perfil_id);
ALTER TABLE usuario_processo ADD CONSTRAINT usuario_processo_usuario_id_usuario_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(usuario_id);
ALTER TABLE usuario_processo ADD CONSTRAINT usuario_processo_processo_id_processo_processo_id FOREIGN KEY (processo_id) REFERENCES processo(processo_id);
ALTER TABLE remember_key ADD CONSTRAINT remember_key_usuario_id_usuario_usuario_id FOREIGN KEY (usuario_id) REFERENCES usuario(usuario_id) ON DELETE CASCADE;
